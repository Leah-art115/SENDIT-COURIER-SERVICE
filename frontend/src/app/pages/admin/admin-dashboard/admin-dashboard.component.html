<h1>Admin Dashboard</h1>

<div class="dashboard-cards">
  <div class="card">
    <h3>Total Earnings</h3>
    <p>KES {{ metrics?.totalEarnings | number:'1.2-2' }}</p>
  </div>

  <div class="card">
    <h3>Total Users</h3>  
    <p>{{ metrics?.totalUsers | number }}</p>
  </div>

  <!-- NEW: Added Total Drivers card -->
  <div class="card">
    <h3>Total Drivers</h3>
    <p>{{ metrics?.totalDrivers | number }}</p>
  </div>

  <!-- <div class="card">
    <h3>In Transit</h3>
    <p>{{ metrics?.parcelsInTransit | number }}</p>
  </div> -->

  <div class="card">
    <h3>Delivered</h3>
    <p>{{ metrics?.parcelsDelivered | number }}</p>
  </div>
</div>

<!-- Add loading indicator -->
<div *ngIf="loading" class="loading-indicator">
  <p>Loading dashboard metrics...</p>
</div>

<!-- Add refresh button -->
<!-- <div class="dashboard-actions">
  <button (click)="refresh()" [disabled]="loading" class="refresh-btn">
    {{ loading ? 'Loading...' : 'Refresh' }}
  </button>
</div> -->

<h2>Recent Activity</h2>
<div class="recent-table">
  <table>
    <thead>
      <tr>
        <th class="col-parcel-id">Parcel ID</th>
        <th class="col-sender">Sender</th>
        <th class="col-receiver">Receiver</th>
        <th class="col-status">Status</th>
        <th class="col-date">Date</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let parcel of metrics?.recentParcels; let i = index" [attr.data-row]="i">
        <td class="col-parcel-id">{{ parcel.trackingId || 'N/A' }}</td>
        <td class="col-sender">{{ parcel.senderName || 'N/A' }}</td>
        <td class="col-receiver">{{ parcel.receiverName || 'N/A' }}</td>
        <td class="col-status">
          <span [ngClass]="{
            'delivered': parcel.status === 'DELIVERED',
            'transit': parcel.status === 'IN_TRANSIT',
            'picked-up': parcel.status === 'PICKED_UP_BY_DRIVER',
            'assigned': parcel.status === 'ASSIGNED',
            'pending': parcel.status === 'PENDING',
            'collected': parcel.status === 'COLLECTED_BY_RECEIVER'
          }">{{ parcel.status || 'N/A' }}</span>
        </td>
        <td class="col-date">{{ parcel.updatedAt | date: 'yyyy-MM-dd HH:mm' }}</td>
      </tr>
      <tr *ngIf="!metrics?.recentParcels?.length">
        <td colspan="5" class="no-data">No recent parcels found</td>
      </tr>
    </tbody>
  </table>
</div>